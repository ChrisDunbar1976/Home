2025-08-13 09:49:00,255 - MOTHistoryImport - INFO - Logging initialized. Log file: Logs\mot_history_import_20250813_094900.log
2025-08-13 09:49:00,255 - MOTHistoryImport - INFO - Configuration loaded: {'database': {'server': 'MLNOESQLUAT01', 'database': 'Engineering', 'trusted_connection': True}, 'files': {'log_directory': 'Logs'}, 'processing': {'batch_size': 100, 'request_timeout': 30, 'max_retries': 3}, 'logging': {'log_level': 'DEBUG'}, 'security': {'client_id_from_env': True, 'client_secret_from_env': True, 'api_key_from_env': True, 'db_password_from_env': False}}
2025-08-13 09:49:00,302 - MOTHistoryImport - INFO - JSON data logging initialized. File: Logs\mot_history_data_20250813_094900.json
2025-08-13 09:49:00,302 - MOTHistoryImport - INFO - Starting Database connection to MLNOESQLUAT01.Engineering with 15-minute retry window
2025-08-13 09:49:00,302 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-13 09:49:00,476 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-13 09:49:00,476 - MOTHistoryImport - DEBUG - Retrieved APIId 2 for service 'GOV MOT History Service'
2025-08-13 09:49:00,476 - MOTHistoryImport - INFO - API logging initialized - APIId: 2
2025-08-13 09:49:00,492 - MOTHistoryImport - DEBUG - API logging enabled for MOTAPIClient with APIId: 2
2025-08-13 09:49:00,492 - MOTHistoryImport - INFO - Starting MOT History Data Import (Bulk Mode)
2025-08-13 09:49:00,492 - MOTHistoryImport - INFO - Starting Database connection to MLNOESQLUAT01.Engineering with 15-minute retry window
2025-08-13 09:49:00,492 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-13 09:49:00,555 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-13 09:49:00,571 - MOTHistoryImport - INFO - Truncating table: StageMOTVehicles
2025-08-13 09:49:00,571 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehicles
2025-08-13 09:49:00,571 - MOTHistoryImport - INFO - Truncating table: StageMOTTests
2025-08-13 09:49:00,587 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTTests
2025-08-13 09:49:00,587 - MOTHistoryImport - INFO - Truncating table: StageMOTDefects
2025-08-13 09:49:00,602 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTDefects
2025-08-13 09:49:00,602 - MOTHistoryImport - INFO - Truncating table: StageMOTVehiclesNotFound
2025-08-13 09:49:00,618 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehiclesNotFound
2025-08-13 09:49:00,618 - MOTHistoryImport - INFO - Reading vehicle registrations from source database: MLNOESQLEXP01
2025-08-13 09:49:00,618 - MOTHistoryImport - INFO - Starting Source database connection to MLNOESQLEXP01.ML-Equinox with 15-minute retry window
2025-08-13 09:49:00,618 - MOTHistoryImport - INFO - Establishing source database connection to MLNOESQLEXP01
2025-08-13 09:49:00,859 - MOTHistoryImport - INFO - Read 2291 vehicle registrations from source database (MLNOESQLEXP01)
2025-08-13 09:49:00,872 - MOTHistoryImport - INFO - Processing batch 1/23 (100 registrations)
2025-08-13 09:49:00,872 - MOTHistoryImport - DEBUG - Processing registration: LK09EOA
2025-08-13 09:49:00,872 - MOTHistoryImport - INFO - Requesting new OAuth2 token...
2025-08-13 09:49:00,872 - MOTHistoryImport - DEBUG - TOKEN_URL: https://login.microsoftonline.com/a455b827-244f-4c97-b5b4-ce5d13b4d00c/oauth2/v2.0/token
2025-08-13 09:49:00,872 - MOTHistoryImport - DEBUG - CLIENT_ID: b6964dc0-b...
2025-08-13 09:49:00,889 - MOTHistoryImport - DEBUG - CLIENT_SECRET: **********...
2025-08-13 09:49:00,889 - MOTHistoryImport - DEBUG - SCOPE_URL: https://tapi.dvsa.gov.uk/.default
2025-08-13 09:49:00,905 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): login.microsoftonline.com:443
2025-08-13 09:49:01,072 - urllib3.connectionpool - DEBUG - https://login.microsoftonline.com:443 "POST /a455b827-244f-4c97-b5b4-ce5d13b4d00c/oauth2/v2.0/token HTTP/1.1" 200 1453
2025-08-13 09:49:01,079 - MOTHistoryImport - INFO - OAuth2 token obtained successfully
2025-08-13 09:49:01,082 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK09EOA
2025-08-13 09:49:01,086 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): history.mot.api.gov.uk:443
2025-08-13 09:49:01,897 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09EOA HTTP/1.1" 200 None
2025-08-13 09:49:01,897 - MOTHistoryImport - WARNING - Failed to log API request for LK09EOA: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:01,960 - MOTHistoryImport - DEBUG - Processing registration: LK10BZD
2025-08-13 09:49:01,973 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK10BZD
2025-08-13 09:49:02,719 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZD HTTP/1.1" 200 None
2025-08-13 09:49:02,723 - MOTHistoryImport - WARNING - Failed to log API request for LK10BZD: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:02,833 - MOTHistoryImport - DEBUG - Processing registration: LK10BZE
2025-08-13 09:49:02,833 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK10BZE
2025-08-13 09:49:03,574 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZE HTTP/1.1" 200 None
2025-08-13 09:49:03,579 - MOTHistoryImport - WARNING - Failed to log API request for LK10BZE: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:03,675 - MOTHistoryImport - DEBUG - Processing registration: LK10BZF
2025-08-13 09:49:03,675 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK10BZF
2025-08-13 09:49:04,328 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZF HTTP/1.1" 200 None
2025-08-13 09:49:04,375 - MOTHistoryImport - WARNING - Failed to log API request for LK10BZF: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:04,501 - MOTHistoryImport - DEBUG - Processing registration: LK10BZG
2025-08-13 09:49:04,501 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK10BZG
2025-08-13 09:49:05,630 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZG HTTP/1.1" 200 None
2025-08-13 09:49:05,647 - MOTHistoryImport - WARNING - Failed to log API request for LK10BZG: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:05,710 - MOTHistoryImport - DEBUG - Processing registration: LK10BZH
2025-08-13 09:49:05,710 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK10BZH
2025-08-13 09:49:06,222 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZH HTTP/1.1" 200 None
2025-08-13 09:49:06,254 - MOTHistoryImport - WARNING - Failed to log API request for LK10BZH: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:06,364 - MOTHistoryImport - DEBUG - Processing registration: LK10BZJ
2025-08-13 09:49:06,379 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK10BZJ
2025-08-13 09:49:07,255 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZJ HTTP/1.1" 200 None
2025-08-13 09:49:07,271 - MOTHistoryImport - WARNING - Failed to log API request for LK10BZJ: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:07,413 - MOTHistoryImport - DEBUG - Processing registration: LK10BZL
2025-08-13 09:49:07,413 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK10BZL
2025-08-13 09:49:08,050 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZL HTTP/1.1" 200 None
2025-08-13 09:49:08,086 - MOTHistoryImport - WARNING - Failed to log API request for LK10BZL: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:08,224 - MOTHistoryImport - DEBUG - Processing registration: LK10BZM
2025-08-13 09:49:08,224 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK10BZM
2025-08-13 09:49:08,842 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZM HTTP/1.1" 200 None
2025-08-13 09:49:08,858 - MOTHistoryImport - WARNING - Failed to log API request for LK10BZM: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:09,001 - MOTHistoryImport - DEBUG - Processing registration: LK10BZN
2025-08-13 09:49:09,001 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK10BZN
2025-08-13 09:49:09,684 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZN HTTP/1.1" 200 None
2025-08-13 09:49:09,684 - MOTHistoryImport - INFO - API Rate - Legacy: 1.28 RPS, Dynamic: 0 RPS (Daily: 10/500000)
2025-08-13 09:49:09,684 - MOTHistoryImport - WARNING - Failed to log API request for LK10BZN: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:09,827 - MOTHistoryImport - DEBUG - Processing registration: LK10BZO
2025-08-13 09:49:09,827 - MOTHistoryImport - DEBUG - Fetching MOT data for registration: LK10BZO
2025-08-13 09:49:11,099 - MOTHistoryImport - WARNING - Failed to log API request for LK10BZO: ('42S22', "[42S22] [Microsoft][ODBC SQL Server Driver][SQL Server]Invalid column name 'requestTime'. (207) (SQLExecDirectW)")
2025-08-13 09:49:11,115 - MOTHistoryImport - INFO - Database connection closed
