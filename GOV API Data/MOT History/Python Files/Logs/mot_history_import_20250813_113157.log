2025-08-13 11:31:57,784 - MOTHistoryImport - INFO - Logging initialized. Log file: Logs\mot_history_import_20250813_113157.log
2025-08-13 11:31:57,800 - MOTHistoryImport - INFO - Configuration loaded: {'database': {'server': 'MLNOESQLUAT01', 'database': 'Engineering', 'trusted_connection': True}, 'files': {'log_directory': 'Logs'}, 'processing': {'batch_size': 100, 'request_timeout': 30, 'max_retries': 3}, 'logging': {'log_level': 'DEBUG'}, 'security': {'client_id_from_env': True, 'client_secret_from_env': True, 'api_key_from_env': True, 'db_password_from_env': False}}
2025-08-13 11:31:57,832 - MOTHistoryImport - INFO - JSON data logging initialized. File: Logs\mot_history_data_20250813_113157.json
2025-08-13 11:31:57,832 - MOTHistoryImport - INFO - Using config rate limit: 15 RPS
2025-08-13 11:31:57,832 - MOTHistoryImport - INFO - Starting Database connection to MLNOESQLUAT01.Engineering with 15-minute retry window
2025-08-13 11:31:57,850 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-13 11:31:57,989 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-13 11:31:57,989 - MOTHistoryImport - DEBUG - Retrieved APIId 2 for service 'GOV MOT History Service'
2025-08-13 11:31:57,989 - MOTHistoryImport - DEBUG - Retrieved rate limit 1 seconds for APIId 2
2025-08-13 11:31:57,989 - MOTHistoryImport - INFO - Updated rate limit from 15.000 to 1.000 RPS (1s interval)
2025-08-13 11:31:58,005 - MOTHistoryImport - INFO - API logging initialized - APIId: 2, Rate Limit: 1s
2025-08-13 11:31:58,005 - MOTHistoryImport - DEBUG - API logging enabled for MOTAPIClient with APIId: 2
2025-08-13 11:31:58,005 - MOTHistoryImport - INFO - Starting MOT History Data Import (Bulk Mode)
2025-08-13 11:31:58,005 - MOTHistoryImport - INFO - Starting Database connection to MLNOESQLUAT01.Engineering with 15-minute retry window
2025-08-13 11:31:58,021 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-13 11:31:58,077 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-13 11:31:58,085 - MOTHistoryImport - INFO - Truncating table: StageMOTVehicles
2025-08-13 11:31:58,085 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehicles
2025-08-13 11:31:58,100 - MOTHistoryImport - INFO - Truncating table: StageMOTTests
2025-08-13 11:31:58,100 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTTests
2025-08-13 11:31:58,116 - MOTHistoryImport - INFO - Truncating table: StageMOTDefects
2025-08-13 11:31:58,116 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTDefects
2025-08-13 11:31:58,116 - MOTHistoryImport - INFO - Truncating table: StageMOTVehiclesNotFound
2025-08-13 11:31:58,132 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehiclesNotFound
2025-08-13 11:31:58,132 - MOTHistoryImport - INFO - Reading vehicle registrations from source database: MLNOESQLEXP01
2025-08-13 11:31:58,132 - MOTHistoryImport - INFO - Starting Source database connection to MLNOESQLEXP01.ML-Equinox with 15-minute retry window
2025-08-13 11:31:58,132 - MOTHistoryImport - INFO - Establishing source database connection to MLNOESQLEXP01
2025-08-13 11:31:58,306 - MOTHistoryImport - INFO - Read 2294 vehicle registrations from source database (MLNOESQLEXP01)
2025-08-13 11:31:58,306 - MOTHistoryImport - INFO - Added 3 test registrations: YX111FH, SK111KZ, SK111PP
2025-08-13 11:31:58,322 - MOTHistoryImport - INFO - Processing batch 1/23 (100 registrations)
2025-08-13 11:31:58,322 - MOTHistoryImport - INFO - Requesting new OAuth2 token...
2025-08-13 11:31:58,337 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): login.microsoftonline.com:443
2025-08-13 11:31:58,459 - urllib3.connectionpool - DEBUG - https://login.microsoftonline.com:443 "POST /a455b827-244f-4c97-b5b4-ce5d13b4d00c/oauth2/v2.0/token HTTP/1.1" 200 1456
2025-08-13 11:31:58,462 - MOTHistoryImport - INFO - OAuth2 token obtained successfully
2025-08-13 11:31:58,462 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): history.mot.api.gov.uk:443
2025-08-13 11:31:59,207 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09EOA HTTP/1.1" 200 None
2025-08-13 11:31:59,783 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZD HTTP/1.1" 200 None
2025-08-13 11:32:00,866 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZE HTTP/1.1" 200 None
2025-08-13 11:32:01,634 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZF HTTP/1.1" 200 None
2025-08-13 11:32:02,472 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZG HTTP/1.1" 200 None
2025-08-13 11:32:03,704 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZH HTTP/1.1" 200 None
2025-08-13 11:32:04,295 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZJ HTTP/1.1" 200 None
2025-08-13 11:32:05,588 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZL HTTP/1.1" 200 None
2025-08-13 11:32:06,242 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZM HTTP/1.1" 200 None
2025-08-13 11:32:06,987 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZN HTTP/1.1" 200 None
2025-08-13 11:32:06,991 - MOTHistoryImport - INFO - API Rate - Legacy: 1.28 RPS, Dynamic: 0 RPS (Daily: 10/500000)
2025-08-13 11:32:07,733 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZO HTTP/1.1" 200 None
2025-08-13 11:32:08,434 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZP HTTP/1.1" 200 None
2025-08-13 11:32:09,275 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZR HTTP/1.1" 200 None
2025-08-13 11:32:10,036 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZS HTTP/1.1" 200 None
2025-08-13 11:32:11,428 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZT HTTP/1.1" 200 None
2025-08-13 11:32:12,709 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZU HTTP/1.1" 200 None
2025-08-13 11:32:13,885 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXD HTTP/1.1" 200 None
2025-08-13 11:32:14,577 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXE HTTP/1.1" 200 None
2025-08-13 11:32:15,382 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXF HTTP/1.1" 200 None
2025-08-13 11:32:16,119 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXG HTTP/1.1" 200 None
2025-08-13 11:32:16,132 - MOTHistoryImport - INFO - API Rate - Legacy: 1.18 RPS, Dynamic: 0 RPS (Daily: 20/500000)
2025-08-13 11:32:16,976 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXJ HTTP/1.1" 200 None
2025-08-13 11:32:17,816 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXL HTTP/1.1" 200 None
2025-08-13 11:32:18,817 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXM HTTP/1.1" 200 None
2025-08-13 11:32:19,756 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXN HTTP/1.1" 200 None
2025-08-13 11:32:20,746 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXO HTTP/1.1" 200 None
2025-08-13 11:32:21,495 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXP HTTP/1.1" 200 None
2025-08-13 11:32:22,229 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXR HTTP/1.1" 200 None
2025-08-13 11:32:23,074 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXS HTTP/1.1" 200 None
2025-08-13 11:32:23,756 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXT HTTP/1.1" 200 None
2025-08-13 11:32:25,073 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXU HTTP/1.1" 200 None
2025-08-13 11:32:25,073 - MOTHistoryImport - INFO - API Rate - Legacy: 1.16 RPS, Dynamic: 0 RPS (Daily: 30/500000)
2025-08-13 11:32:25,963 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXV HTTP/1.1" 200 None
2025-08-13 11:32:26,758 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXW HTTP/1.1" 200 None
2025-08-13 11:32:27,822 - MOTHistoryImport - INFO - Database connection closed
