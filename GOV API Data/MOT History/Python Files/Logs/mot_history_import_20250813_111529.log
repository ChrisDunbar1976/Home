2025-08-13 11:15:29,962 - MOTHistoryImport - INFO - Logging initialized. Log file: Logs\mot_history_import_20250813_111529.log
2025-08-13 11:15:29,962 - MOTHistoryImport - INFO - Configuration loaded: {'database': {'server': 'MLNOESQLUAT01', 'database': 'Engineering', 'trusted_connection': True}, 'files': {'log_directory': 'Logs'}, 'processing': {'batch_size': 100, 'request_timeout': 30, 'max_retries': 3}, 'logging': {'log_level': 'DEBUG'}, 'security': {'client_id_from_env': True, 'client_secret_from_env': True, 'api_key_from_env': True, 'db_password_from_env': False}}
2025-08-13 11:15:30,010 - MOTHistoryImport - INFO - JSON data logging initialized. File: Logs\mot_history_data_20250813_111529.json
2025-08-13 11:15:30,027 - MOTHistoryImport - INFO - Using config rate limit: 15 RPS
2025-08-13 11:15:30,031 - MOTHistoryImport - INFO - Starting Database connection to MLNOESQLUAT01.Engineering with 15-minute retry window
2025-08-13 11:15:30,033 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-13 11:15:30,148 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-13 11:15:30,153 - MOTHistoryImport - DEBUG - Retrieved APIId 2 for service 'GOV MOT History Service'
2025-08-13 11:15:30,153 - MOTHistoryImport - DEBUG - Retrieved rate limit 1 seconds for APIId 2
2025-08-13 11:15:30,153 - MOTHistoryImport - INFO - Updated rate limit from 15.000 to 1.000 RPS (1s interval)
2025-08-13 11:15:30,153 - MOTHistoryImport - INFO - API logging initialized - APIId: 2, Rate Limit: 1s
2025-08-13 11:15:30,167 - MOTHistoryImport - DEBUG - API logging enabled for MOTAPIClient with APIId: 2
2025-08-13 11:15:30,167 - MOTHistoryImport - INFO - Starting MOT History Data Import (Bulk Mode)
2025-08-13 11:15:30,167 - MOTHistoryImport - INFO - Starting Database connection to MLNOESQLUAT01.Engineering with 15-minute retry window
2025-08-13 11:15:30,175 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-13 11:15:30,239 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-13 11:15:30,244 - MOTHistoryImport - INFO - Truncating table: StageMOTVehicles
2025-08-13 11:15:30,252 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehicles
2025-08-13 11:15:30,254 - MOTHistoryImport - INFO - Truncating table: StageMOTTests
2025-08-13 11:15:30,263 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTTests
2025-08-13 11:15:30,273 - MOTHistoryImport - INFO - Truncating table: StageMOTDefects
2025-08-13 11:15:30,283 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTDefects
2025-08-13 11:15:30,285 - MOTHistoryImport - INFO - Truncating table: StageMOTVehiclesNotFound
2025-08-13 11:15:30,297 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehiclesNotFound
2025-08-13 11:15:30,301 - MOTHistoryImport - INFO - Reading vehicle registrations from source database: MLNOESQLEXP01
2025-08-13 11:15:30,303 - MOTHistoryImport - INFO - Starting Source database connection to MLNOESQLEXP01.ML-Equinox with 15-minute retry window
2025-08-13 11:15:30,307 - MOTHistoryImport - INFO - Establishing source database connection to MLNOESQLEXP01
2025-08-13 11:15:30,549 - MOTHistoryImport - INFO - Read 2291 vehicle registrations from source database (MLNOESQLEXP01)
2025-08-13 11:15:30,558 - MOTHistoryImport - INFO - Processing batch 1/23 (100 registrations)
2025-08-13 11:15:30,562 - MOTHistoryImport - INFO - Requesting new OAuth2 token...
2025-08-13 11:15:30,587 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): login.microsoftonline.com:443
2025-08-13 11:15:30,719 - urllib3.connectionpool - DEBUG - https://login.microsoftonline.com:443 "POST /a455b827-244f-4c97-b5b4-ce5d13b4d00c/oauth2/v2.0/token HTTP/1.1" 200 1453
2025-08-13 11:15:30,723 - MOTHistoryImport - INFO - OAuth2 token obtained successfully
2025-08-13 11:15:30,723 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): history.mot.api.gov.uk:443
2025-08-13 11:15:31,803 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09EOA HTTP/1.1" 200 None
2025-08-13 11:15:32,661 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZD HTTP/1.1" 200 None
2025-08-13 11:15:35,010 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZE HTTP/1.1" 200 None
2025-08-13 11:15:35,883 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZF HTTP/1.1" 200 None
2025-08-13 11:15:36,756 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZG HTTP/1.1" 200 None
2025-08-13 11:15:38,231 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZH HTTP/1.1" 200 None
2025-08-13 11:15:39,071 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZJ HTTP/1.1" 200 None
2025-08-13 11:15:40,230 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZL HTTP/1.1" 200 None
2025-08-13 11:15:41,070 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZM HTTP/1.1" 200 None
2025-08-13 11:15:41,760 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZN HTTP/1.1" 200 None
2025-08-13 11:15:41,769 - MOTHistoryImport - INFO - API Rate - Legacy: 1.00 RPS, Dynamic: 0 RPS (Daily: 10/500000)
2025-08-13 11:15:42,896 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZO HTTP/1.1" 200 None
2025-08-13 11:15:43,704 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZP HTTP/1.1" 200 None
2025-08-13 11:15:44,544 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZR HTTP/1.1" 200 None
2025-08-13 11:15:45,465 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZS HTTP/1.1" 200 None
2025-08-13 11:15:46,636 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZT HTTP/1.1" 200 None
2025-08-13 11:15:47,619 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK10BZU HTTP/1.1" 200 None
2025-08-13 11:15:48,695 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXD HTTP/1.1" 200 None
2025-08-13 11:15:49,559 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXE HTTP/1.1" 200 None
2025-08-13 11:15:50,445 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXF HTTP/1.1" 200 None
2025-08-13 11:15:51,220 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXG HTTP/1.1" 200 None
2025-08-13 11:15:51,220 - MOTHistoryImport - INFO - API Rate - Legacy: 1.03 RPS, Dynamic: 0 RPS (Daily: 20/500000)
2025-08-13 11:15:52,121 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXJ HTTP/1.1" 200 None
2025-08-13 11:15:53,307 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXL HTTP/1.1" 200 None
2025-08-13 11:15:54,304 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXM HTTP/1.1" 200 None
2025-08-13 11:15:55,136 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXN HTTP/1.1" 200 None
2025-08-13 11:15:55,838 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXO HTTP/1.1" 200 None
2025-08-13 11:15:56,837 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXP HTTP/1.1" 200 None
2025-08-13 11:15:57,649 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXR HTTP/1.1" 200 None
2025-08-13 11:15:58,504 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXS HTTP/1.1" 200 None
2025-08-13 11:15:59,313 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXT HTTP/1.1" 200 None
2025-08-13 11:16:00,419 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXU HTTP/1.1" 200 None
2025-08-13 11:16:00,451 - MOTHistoryImport - INFO - API Rate - Legacy: 1.05 RPS, Dynamic: 0 RPS (Daily: 30/500000)
2025-08-13 11:16:01,277 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXV HTTP/1.1" 200 None
2025-08-13 11:16:02,051 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXW HTTP/1.1" 200 None
2025-08-13 11:16:03,026 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXX HTTP/1.1" 200 None
2025-08-13 11:16:04,063 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXY HTTP/1.1" 200 None
2025-08-13 11:16:04,937 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CXZ HTTP/1.1" 200 None
2025-08-13 11:16:05,914 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYA HTTP/1.1" 200 None
2025-08-13 11:16:06,588 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYE HTTP/1.1" 200 None
2025-08-13 11:16:07,776 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYF HTTP/1.1" 200 None
2025-08-13 11:16:08,574 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYH HTTP/1.1" 200 None
2025-08-13 11:16:09,465 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYJ HTTP/1.1" 200 None
2025-08-13 11:16:09,529 - MOTHistoryImport - INFO - API Rate - Legacy: 1.06 RPS, Dynamic: 0 RPS (Daily: 40/500000)
2025-08-13 11:16:10,352 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYL HTTP/1.1" 200 None
2025-08-13 11:16:11,464 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYO HTTP/1.1" 200 None
2025-08-13 11:16:12,210 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYP HTTP/1.1" 200 None
2025-08-13 11:16:13,244 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYS HTTP/1.1" 200 None
2025-08-13 11:16:14,231 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYT HTTP/1.1" 200 None
2025-08-13 11:16:15,456 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK11CYV HTTP/1.1" 200 None
2025-08-13 11:16:16,324 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK61BJE HTTP/1.1" 200 None
2025-08-13 11:16:17,214 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK61BJF HTTP/1.1" 200 None
2025-08-13 11:16:18,045 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK61BJJ HTTP/1.1" 200 None
2025-08-13 11:16:18,607 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK57EJA HTTP/1.1" 200 None
2025-08-13 11:16:18,607 - MOTHistoryImport - INFO - API Rate - Legacy: 1.07 RPS, Dynamic: 0 RPS (Daily: 50/500000)
2025-08-13 11:16:19,738 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09ENC HTTP/1.1" 200 None
2025-08-13 11:16:20,525 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09ENE HTTP/1.1" 200 None
2025-08-13 11:16:21,354 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09ENF HTTP/1.1" 200 None
2025-08-13 11:16:22,198 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09ENH HTTP/1.1" 200 None
2025-08-13 11:16:23,156 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09ENN HTTP/1.1" 200 None
2025-08-13 11:16:23,956 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09ENO HTTP/1.1" 200 None
2025-08-13 11:16:24,862 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09ENP HTTP/1.1" 200 None
2025-08-13 11:16:25,721 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK09ENR HTTP/1.1" 200 None
2025-08-13 11:16:26,631 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK59AVB HTTP/1.1" 200 None
2025-08-13 11:16:27,412 - urllib3.connectionpool - DEBUG - https://history.mot.api.gov.uk:443 "GET /v1/trade/vehicles/registration/LK59AVC HTTP/1.1" 200 None
2025-08-13 11:16:27,415 - MOTHistoryImport - INFO - API Rate - Legacy: 1.08 RPS, Dynamic: 0 RPS (Daily: 60/500000)
2025-08-13 11:16:28,569 - MOTHistoryImport - INFO - Database connection closed
