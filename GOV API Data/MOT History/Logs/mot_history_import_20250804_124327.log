2025-08-04 12:43:27,679 - MOTHistoryImport - INFO - Logging initialized. Log file: Logs\mot_history_import_20250804_124327.log
2025-08-04 12:43:27,696 - MOTHistoryImport - INFO - Configuration loaded: {'database': {'server': 'MLNOESQLUAT01', 'database': 'Engineering', 'trusted_connection': True}, 'files': {'input_csv_file': 'vehicle_registrations_new.csv', 'log_directory': 'Logs'}, 'processing': {'batch_size': 100, 'request_timeout': 30, 'max_retries': 3}, 'logging': {'log_level': 'INFO'}}
2025-08-04 12:43:27,880 - MOTHistoryImport - INFO - JSON data logging initialized. File: Logs\mot_history_data_20250804_124327.json
2025-08-04 12:43:27,895 - MOTHistoryImport - INFO - Starting MOT History Data Import (Bulk Mode)
2025-08-04 12:43:27,912 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-04 12:43:28,408 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-04 12:43:28,437 - MOTHistoryImport - INFO - Truncating table: StageMOTVehicles
2025-08-04 12:43:28,565 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehicles
2025-08-04 12:43:28,585 - MOTHistoryImport - INFO - Truncating table: StageMOTTests
2025-08-04 12:43:28,664 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTTests
2025-08-04 12:43:28,679 - MOTHistoryImport - INFO - Truncating table: StageMOTDefects
2025-08-04 12:43:28,730 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTDefects
2025-08-04 12:43:28,746 - MOTHistoryImport - INFO - Truncating table: StageMOTVehiclesNotFound
2025-08-04 12:43:28,793 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehiclesNotFound
2025-08-04 12:43:28,810 - MOTHistoryImport - INFO - Reading vehicle registrations from SQL Server view
2025-08-04 12:43:28,829 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-04 12:43:29,087 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-04 12:43:29,292 - MOTHistoryImport - INFO - Read 2287 vehicle registrations from SQL Server
2025-08-04 12:43:29,313 - MOTHistoryImport - INFO - Processing batch 1/23 (100 registrations)
2025-08-04 12:43:29,346 - MOTHistoryImport - INFO - Requesting new OAuth2 token...
2025-08-04 12:43:29,665 - MOTHistoryImport - INFO - OAuth2 token obtained successfully
2025-08-04 12:43:41,847 - MOTHistoryImport - INFO - Current API rate: 0.89 RPS (Total requests: 10)
2025-08-04 12:43:57,614 - MOTHistoryImport - INFO - Current API rate: 0.74 RPS (Total requests: 20)
2025-08-04 12:44:16,040 - MOTHistoryImport - INFO - Current API rate: 0.66 RPS (Total requests: 30)
2025-08-04 12:44:38,354 - MOTHistoryImport - INFO - Current API rate: 0.57 RPS (Total requests: 40)
2025-08-04 12:45:03,445 - MOTHistoryImport - INFO - Current API rate: 0.45 RPS (Total requests: 50)
2025-08-04 12:45:30,578 - MOTHistoryImport - INFO - Current API rate: 0.41 RPS (Total requests: 60)
2025-08-04 12:46:00,540 - MOTHistoryImport - INFO - Current API rate: 0.37 RPS (Total requests: 70)
2025-08-04 12:46:35,214 - MOTHistoryImport - INFO - Current API rate: 0.33 RPS (Total requests: 80)
2025-08-04 12:47:12,393 - MOTHistoryImport - INFO - Current API rate: 0.29 RPS (Total requests: 90)
2025-08-04 12:47:53,554 - MOTHistoryImport - INFO - Current API rate: 0.26 RPS (Total requests: 100)
2025-08-04 12:47:56,687 - MOTHistoryImport - INFO - Bulk inserting 100 vehicle records...
2025-08-04 12:47:59,747 - MOTHistoryImport - INFO - Successfully bulk inserted 100 vehicle records
2025-08-04 12:47:59,761 - MOTHistoryImport - INFO - Bulk inserting 715 test records...
2025-08-04 12:48:22,016 - MOTHistoryImport - INFO - Successfully bulk inserted 715 test records
2025-08-04 12:48:22,034 - MOTHistoryImport - INFO - Bulk inserting 146 defect records...
2025-08-04 12:48:26,692 - MOTHistoryImport - INFO - Successfully bulk inserted 146 defect records
2025-08-04 12:48:26,722 - MOTHistoryImport - INFO - Bulk batch committed: 100 successful, 0 failed, 100 vehicles, 715 tests, 146 defects, 0 not found
2025-08-04 12:48:26,740 - MOTHistoryImport - INFO - Progress: 4.4% (100/2287)
2025-08-04 12:48:26,756 - MOTHistoryImport - INFO - Processing batch 2/23 (100 registrations)
2025-08-04 12:49:07,784 - MOTHistoryImport - INFO - Current API rate: 0.25 RPS (Total requests: 110)
2025-08-04 12:49:56,535 - MOTHistoryImport - INFO - Current API rate: 0.22 RPS (Total requests: 120)
2025-08-04 12:50:54,952 - MOTHistoryImport - INFO - Current API rate: 0.19 RPS (Total requests: 130)
2025-08-04 12:52:00,770 - MOTHistoryImport - INFO - Current API rate: 0.17 RPS (Total requests: 140)
2025-08-04 12:53:13,218 - MOTHistoryImport - INFO - Current API rate: 0.15 RPS (Total requests: 150)
2025-08-04 12:54:25,254 - MOTHistoryImport - INFO - Current API rate: 0.16 RPS (Total requests: 160)
2025-08-04 12:55:40,496 - MOTHistoryImport - INFO - Current API rate: 0.15 RPS (Total requests: 170)
2025-08-04 12:57:00,151 - MOTHistoryImport - INFO - Current API rate: 0.14 RPS (Total requests: 180)
2025-08-04 12:58:18,272 - MOTHistoryImport - INFO - Current API rate: 0.14 RPS (Total requests: 190)
2025-08-04 12:59:38,984 - MOTHistoryImport - INFO - Current API rate: 0.14 RPS (Total requests: 200)
2025-08-04 12:59:46,557 - MOTHistoryImport - INFO - Bulk inserting 100 vehicle records...
2025-08-04 12:59:46,571 - MOTHistoryImport - WARNING - Truncating long value for key 'fuelType': Hybrid Electric (Clean)... (length: 23 -> 20)
2025-08-04 12:59:46,606 - MOTHistoryImport - WARNING - Truncating long value for key 'fuelType': Hybrid Electric (Clean)... (length: 23 -> 20)
2025-08-04 12:59:49,643 - MOTHistoryImport - INFO - Successfully bulk inserted 100 vehicle records
2025-08-04 12:59:49,659 - MOTHistoryImport - INFO - Bulk inserting 786 test records...
2025-08-04 13:00:13,978 - MOTHistoryImport - INFO - Successfully bulk inserted 786 test records
2025-08-04 13:00:13,994 - MOTHistoryImport - INFO - Bulk inserting 940 defect records...
2025-08-04 13:00:43,906 - MOTHistoryImport - INFO - Successfully bulk inserted 940 defect records
2025-08-04 13:00:43,938 - MOTHistoryImport - INFO - Bulk batch committed: 100 successful, 0 failed, 100 vehicles, 786 tests, 940 defects, 0 not found
2025-08-04 13:00:43,956 - MOTHistoryImport - INFO - Progress: 8.7% (200/2287)
2025-08-04 13:00:43,967 - MOTHistoryImport - INFO - Processing batch 3/23 (100 registrations)
2025-08-04 13:02:01,475 - MOTHistoryImport - INFO - Current API rate: 0.13 RPS (Total requests: 210)
2025-08-04 13:03:32,492 - MOTHistoryImport - INFO - Current API rate: 0.13 RPS (Total requests: 220)
2025-08-04 13:05:04,207 - MOTHistoryImport - INFO - Current API rate: 0.13 RPS (Total requests: 230)
2025-08-04 13:06:42,194 - MOTHistoryImport - INFO - Current API rate: 0.12 RPS (Total requests: 240)
2025-08-04 13:08:22,037 - MOTHistoryImport - INFO - Current API rate: 0.12 RPS (Total requests: 250)
2025-08-04 13:10:03,138 - MOTHistoryImport - INFO - Current API rate: 0.12 RPS (Total requests: 260)
2025-08-04 13:11:47,291 - MOTHistoryImport - INFO - Current API rate: 0.11 RPS (Total requests: 270)
2025-08-04 13:13:34,012 - MOTHistoryImport - INFO - Current API rate: 0.11 RPS (Total requests: 280)
2025-08-04 13:15:23,510 - MOTHistoryImport - INFO - Current API rate: 0.12 RPS (Total requests: 290)
2025-08-04 13:17:26,319 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 300)
2025-08-04 13:17:37,353 - MOTHistoryImport - INFO - Bulk inserting 100 vehicle records...
2025-08-04 13:17:40,575 - MOTHistoryImport - INFO - Successfully bulk inserted 100 vehicle records
2025-08-04 13:17:40,595 - MOTHistoryImport - INFO - Bulk inserting 758 test records...
2025-08-04 13:18:04,358 - MOTHistoryImport - INFO - Successfully bulk inserted 758 test records
2025-08-04 13:18:04,374 - MOTHistoryImport - INFO - Bulk inserting 119 defect records...
2025-08-04 13:18:08,473 - MOTHistoryImport - INFO - Successfully bulk inserted 119 defect records
2025-08-04 13:18:08,508 - MOTHistoryImport - INFO - Bulk batch committed: 100 successful, 0 failed, 100 vehicles, 758 tests, 119 defects, 0 not found
2025-08-04 13:18:08,526 - MOTHistoryImport - INFO - Progress: 13.1% (300/2287)
2025-08-04 13:18:08,541 - MOTHistoryImport - INFO - Processing batch 4/23 (100 registrations)
2025-08-04 13:19:50,160 - MOTHistoryImport - INFO - Current API rate: 0.11 RPS (Total requests: 310)
2025-08-04 13:21:46,862 - MOTHistoryImport - INFO - Current API rate: 0.10 RPS (Total requests: 320)
2025-08-04 13:23:53,761 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 330)
2025-08-04 13:25:59,696 - MOTHistoryImport - INFO - Current API rate: 0.10 RPS (Total requests: 340)
2025-08-04 13:28:08,106 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 350)
2025-08-04 13:30:10,790 - MOTHistoryImport - INFO - Current API rate: 0.10 RPS (Total requests: 360)
2025-08-04 13:32:25,555 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 370)
2025-08-04 13:34:42,055 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 380)
2025-08-04 13:36:56,609 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 390)
2025-08-04 13:39:11,603 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 400)
2025-08-04 13:39:25,961 - MOTHistoryImport - INFO - Bulk inserting 100 vehicle records...
2025-08-04 13:39:29,281 - MOTHistoryImport - INFO - Successfully bulk inserted 100 vehicle records
2025-08-04 13:39:29,294 - MOTHistoryImport - INFO - Bulk inserting 769 test records...
2025-08-04 13:39:53,734 - MOTHistoryImport - INFO - Successfully bulk inserted 769 test records
2025-08-04 13:39:53,750 - MOTHistoryImport - INFO - Bulk inserting 121 defect records...
2025-08-04 13:39:57,720 - MOTHistoryImport - INFO - Successfully bulk inserted 121 defect records
2025-08-04 13:39:57,750 - MOTHistoryImport - INFO - Bulk batch committed: 100 successful, 0 failed, 100 vehicles, 769 tests, 121 defects, 0 not found
2025-08-04 13:39:57,764 - MOTHistoryImport - INFO - Progress: 17.5% (400/2287)
2025-08-04 13:39:57,780 - MOTHistoryImport - INFO - Processing batch 5/23 (100 registrations)
2025-08-04 13:42:02,531 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 410)
2025-08-04 13:42:29,184 - MOTHistoryImport - INFO - Requesting new OAuth2 token...
2025-08-04 13:42:29,346 - MOTHistoryImport - INFO - OAuth2 token obtained successfully
2025-08-04 13:44:22,690 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 420)
2025-08-04 13:46:47,426 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 430)
2025-08-04 13:48:47,801 - MOTHistoryImport - WARNING - Registration not found in MOT API: LTZ1016
2025-08-04 13:49:05,173 - MOTHistoryImport - WARNING - Registration not found in MOT API: LTZ1011
2025-08-04 13:49:51,002 - MOTHistoryImport - INFO - Current API rate: 0.10 RPS (Total requests: 440)
2025-08-04 13:52:27,116 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 450)
2025-08-04 13:54:59,782 - MOTHistoryImport - INFO - Current API rate: 0.08 RPS (Total requests: 460)
2025-08-04 13:57:35,418 - MOTHistoryImport - INFO - Current API rate: 0.09 RPS (Total requests: 470)
2025-08-04 14:00:12,804 - MOTHistoryImport - INFO - Current API rate: 0.08 RPS (Total requests: 480)
2025-08-04 14:03:02,784 - MOTHistoryImport - INFO - Current API rate: 0.08 RPS (Total requests: 490)
2025-08-04 14:05:26,134 - MOTHistoryImport - INFO - Bulk inserting 98 vehicle records...
2025-08-04 14:05:29,545 - MOTHistoryImport - INFO - Successfully bulk inserted 98 vehicle records
2025-08-04 14:05:29,559 - MOTHistoryImport - INFO - Bulk inserting 743 test records...
2025-08-04 14:05:52,961 - MOTHistoryImport - INFO - Successfully bulk inserted 743 test records
2025-08-04 14:05:52,975 - MOTHistoryImport - INFO - Bulk inserting 152 defect records...
2025-08-04 14:05:59,571 - MOTHistoryImport - INFO - Successfully bulk inserted 152 defect records
2025-08-04 14:05:59,587 - MOTHistoryImport - INFO - Bulk inserting 2 not found registrations...
2025-08-04 14:05:59,692 - MOTHistoryImport - INFO - Successfully bulk inserted 2 not found registrations
2025-08-04 14:05:59,724 - MOTHistoryImport - INFO - Bulk batch committed: 98 successful, 2 failed, 98 vehicles, 743 tests, 152 defects, 2 not found
2025-08-04 14:05:59,743 - MOTHistoryImport - INFO - Progress: 21.9% (500/2287)
2025-08-04 14:05:59,758 - MOTHistoryImport - INFO - Processing batch 6/23 (100 registrations)
2025-08-04 14:06:17,260 - MOTHistoryImport - INFO - Current API rate: 0.12 RPS (Total requests: 500)
2025-08-04 14:09:09,349 - MOTHistoryImport - INFO - Current API rate: 0.08 RPS (Total requests: 510)
2025-08-04 14:12:07,447 - MOTHistoryImport - INFO - Current API rate: 0.07 RPS (Total requests: 520)
2025-08-04 14:14:55,890 - MOTHistoryImport - INFO - Current API rate: 0.08 RPS (Total requests: 530)
2025-08-04 14:17:55,371 - MOTHistoryImport - INFO - Current API rate: 0.07 RPS (Total requests: 540)
2025-08-04 14:21:01,084 - MOTHistoryImport - INFO - Current API rate: 0.07 RPS (Total requests: 550)
2025-08-04 14:22:48,911 - MOTHistoryImport - INFO - Database connection closed
