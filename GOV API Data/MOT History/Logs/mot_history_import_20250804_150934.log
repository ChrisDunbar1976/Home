2025-08-04 15:09:34,698 - MOTHistoryImport - INFO - Logging initialized. Log file: Logs\mot_history_import_20250804_150934.log
2025-08-04 15:09:34,714 - MOTHistoryImport - INFO - Configuration loaded: {'database': {'server': 'MLNOESQLUAT01', 'database': 'Engineering', 'trusted_connection': True}, 'files': {'input_csv_file': 'vehicle_registrations_new.csv', 'log_directory': 'Logs'}, 'processing': {'batch_size': 100, 'request_timeout': 30, 'max_retries': 3}, 'logging': {'log_level': 'INFO'}, 'security': {'client_id_from_env': True, 'client_secret_from_env': True, 'api_key_from_env': True, 'db_password_from_env': False}}
2025-08-04 15:09:34,892 - MOTHistoryImport - INFO - JSON data logging initialized. File: Logs\mot_history_data_20250804_150934.json
2025-08-04 15:09:34,905 - MOTHistoryImport - INFO - Starting MOT History Data Import (Bulk Mode)
2025-08-04 15:09:34,921 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-04 15:09:35,366 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-04 15:09:35,377 - MOTHistoryImport - INFO - Truncating table: StageMOTVehicles
2025-08-04 15:09:35,427 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehicles
2025-08-04 15:09:35,443 - MOTHistoryImport - INFO - Truncating table: StageMOTTests
2025-08-04 15:09:35,497 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTTests
2025-08-04 15:09:35,512 - MOTHistoryImport - INFO - Truncating table: StageMOTDefects
2025-08-04 15:09:35,558 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTDefects
2025-08-04 15:09:35,575 - MOTHistoryImport - INFO - Truncating table: StageMOTVehiclesNotFound
2025-08-04 15:09:35,619 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehiclesNotFound
2025-08-04 15:09:35,635 - MOTHistoryImport - INFO - Reading vehicle registrations from SQL Server view
2025-08-04 15:09:35,651 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-04 15:09:35,908 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-04 15:09:36,045 - MOTHistoryImport - INFO - Read 2285 vehicle registrations from SQL Server
2025-08-04 15:09:36,063 - MOTHistoryImport - INFO - Processing batch 1/23 (100 registrations)
2025-08-04 15:09:36,077 - MOTHistoryImport - INFO - Requesting new OAuth2 token...
2025-08-04 15:09:36,281 - MOTHistoryImport - INFO - OAuth2 token obtained successfully
2025-08-04 15:09:47,811 - MOTHistoryImport - INFO - API Rate - Legacy: 1.01 RPS, Dynamic: 0 RPS (Daily: 10/500000)
2025-08-04 15:10:02,243 - MOTHistoryImport - INFO - API Rate - Legacy: 0.82 RPS, Dynamic: 0 RPS (Daily: 20/500000)
2025-08-04 15:10:21,906 - MOTHistoryImport - INFO - API Rate - Legacy: 0.68 RPS, Dynamic: 0 RPS (Daily: 30/500000)
2025-08-04 15:10:43,663 - MOTHistoryImport - INFO - API Rate - Legacy: 0.57 RPS, Dynamic: 0 RPS (Daily: 40/500000)
2025-08-04 15:11:08,556 - MOTHistoryImport - INFO - API Rate - Legacy: 0.46 RPS, Dynamic: 0 RPS (Daily: 50/500000)
2025-08-04 15:11:37,803 - MOTHistoryImport - INFO - API Rate - Legacy: 0.39 RPS, Dynamic: 0 RPS (Daily: 60/500000)
2025-08-04 15:12:17,043 - MOTHistoryImport - INFO - API Rate - Legacy: 0.29 RPS, Dynamic: 0 RPS (Daily: 70/500000)
2025-08-04 15:12:51,878 - MOTHistoryImport - INFO - API Rate - Legacy: 0.28 RPS, Dynamic: 0 RPS (Daily: 80/500000)
2025-08-04 15:13:30,119 - MOTHistoryImport - INFO - API Rate - Legacy: 0.29 RPS, Dynamic: 0 RPS (Daily: 90/500000)
2025-08-04 15:14:11,004 - MOTHistoryImport - INFO - API Rate - Legacy: 0.27 RPS, Dynamic: 0 RPS (Daily: 100/500000)
2025-08-04 15:14:14,511 - MOTHistoryImport - INFO - Bulk inserting 100 vehicle records...
2025-08-04 15:14:17,614 - MOTHistoryImport - INFO - Successfully bulk inserted 100 vehicle records
2025-08-04 15:14:17,646 - MOTHistoryImport - INFO - Bulk inserting 715 test records...
2025-08-04 15:14:40,619 - MOTHistoryImport - INFO - Successfully bulk inserted 715 test records
2025-08-04 15:14:40,635 - MOTHistoryImport - INFO - Bulk inserting 146 defect records...
2025-08-04 15:14:45,384 - MOTHistoryImport - INFO - Successfully bulk inserted 146 defect records
2025-08-04 15:14:45,425 - MOTHistoryImport - INFO - Bulk batch committed: 100 successful, 0 failed, 100 vehicles, 715 tests, 146 defects, 0 not found
2025-08-04 15:14:45,442 - MOTHistoryImport - INFO - Progress: 4.4% (100/2285)
2025-08-04 15:14:45,457 - MOTHistoryImport - INFO - Processing batch 2/23 (100 registrations)
2025-08-04 15:15:28,159 - MOTHistoryImport - INFO - API Rate - Legacy: 0.24 RPS, Dynamic: 0 RPS (Daily: 110/500000)
2025-08-04 15:16:17,794 - MOTHistoryImport - INFO - API Rate - Legacy: 0.22 RPS, Dynamic: 0 RPS (Daily: 120/500000)
2025-08-04 15:17:16,417 - MOTHistoryImport - INFO - API Rate - Legacy: 0.19 RPS, Dynamic: 0 RPS (Daily: 130/500000)
2025-08-04 15:18:23,688 - MOTHistoryImport - INFO - API Rate - Legacy: 0.17 RPS, Dynamic: 0 RPS (Daily: 140/500000)
2025-08-04 15:19:37,148 - MOTHistoryImport - INFO - API Rate - Legacy: 0.16 RPS, Dynamic: 0 RPS (Daily: 150/500000)
2025-08-04 15:20:52,465 - MOTHistoryImport - INFO - API Rate - Legacy: 0.15 RPS, Dynamic: 0 RPS (Daily: 160/500000)
2025-08-04 15:22:08,675 - MOTHistoryImport - INFO - API Rate - Legacy: 0.15 RPS, Dynamic: 0 RPS (Daily: 170/500000)
2025-08-04 15:23:28,600 - MOTHistoryImport - INFO - API Rate - Legacy: 0.14 RPS, Dynamic: 0 RPS (Daily: 180/500000)
2025-08-04 15:24:48,347 - MOTHistoryImport - INFO - API Rate - Legacy: 0.14 RPS, Dynamic: 0 RPS (Daily: 190/500000)
2025-08-04 15:26:11,610 - MOTHistoryImport - INFO - API Rate - Legacy: 0.14 RPS, Dynamic: 0 RPS (Daily: 200/500000)
2025-08-04 15:26:19,225 - MOTHistoryImport - INFO - Bulk inserting 100 vehicle records...
2025-08-04 15:26:19,242 - MOTHistoryImport - WARNING - Truncating long value for key 'fuelType': Hybrid Electric (Clean)... (length: 23 -> 20)
2025-08-04 15:26:19,265 - MOTHistoryImport - WARNING - Truncating long value for key 'fuelType': Hybrid Electric (Clean)... (length: 23 -> 20)
2025-08-04 15:26:22,287 - MOTHistoryImport - INFO - Successfully bulk inserted 100 vehicle records
2025-08-04 15:26:22,316 - MOTHistoryImport - INFO - Bulk inserting 787 test records...
2025-08-04 15:26:47,109 - MOTHistoryImport - INFO - Successfully bulk inserted 787 test records
2025-08-04 15:26:47,125 - MOTHistoryImport - INFO - Bulk inserting 933 defect records...
2025-08-04 15:27:16,668 - MOTHistoryImport - INFO - Successfully bulk inserted 933 defect records
2025-08-04 15:27:16,700 - MOTHistoryImport - INFO - Bulk batch committed: 100 successful, 0 failed, 100 vehicles, 787 tests, 933 defects, 0 not found
2025-08-04 15:27:16,722 - MOTHistoryImport - INFO - Progress: 8.8% (200/2285)
2025-08-04 15:27:16,732 - MOTHistoryImport - INFO - Processing batch 3/23 (100 registrations)
2025-08-04 15:28:35,352 - MOTHistoryImport - INFO - API Rate - Legacy: 0.13 RPS, Dynamic: 0 RPS (Daily: 210/500000)
2025-08-04 15:30:05,503 - MOTHistoryImport - INFO - API Rate - Legacy: 0.13 RPS, Dynamic: 0 RPS (Daily: 220/500000)
2025-08-04 15:31:39,628 - MOTHistoryImport - INFO - API Rate - Legacy: 0.12 RPS, Dynamic: 0 RPS (Daily: 230/500000)
2025-08-04 15:33:13,054 - MOTHistoryImport - INFO - API Rate - Legacy: 0.13 RPS, Dynamic: 0 RPS (Daily: 240/500000)
2025-08-04 15:34:46,525 - MOTHistoryImport - INFO - API Rate - Legacy: 0.12 RPS, Dynamic: 0 RPS (Daily: 250/500000)
2025-08-04 15:36:27,306 - MOTHistoryImport - INFO - API Rate - Legacy: 0.12 RPS, Dynamic: 0 RPS (Daily: 260/500000)
2025-08-04 15:38:09,868 - MOTHistoryImport - INFO - API Rate - Legacy: 0.12 RPS, Dynamic: 0 RPS (Daily: 270/500000)
2025-08-04 15:39:57,206 - MOTHistoryImport - INFO - API Rate - Legacy: 0.11 RPS, Dynamic: 0 RPS (Daily: 280/500000)
2025-08-04 15:41:44,758 - MOTHistoryImport - INFO - API Rate - Legacy: 0.11 RPS, Dynamic: 0 RPS (Daily: 290/500000)
2025-08-04 15:43:33,416 - MOTHistoryImport - INFO - API Rate - Legacy: 0.11 RPS, Dynamic: 0 RPS (Daily: 300/500000)
2025-08-04 15:43:44,043 - MOTHistoryImport - INFO - Bulk inserting 100 vehicle records...
2025-08-04 15:43:47,125 - MOTHistoryImport - INFO - Successfully bulk inserted 100 vehicle records
2025-08-04 15:43:47,140 - MOTHistoryImport - INFO - Bulk inserting 761 test records...
2025-08-04 15:44:10,580 - MOTHistoryImport - INFO - Successfully bulk inserted 761 test records
2025-08-04 15:44:10,599 - MOTHistoryImport - INFO - Bulk inserting 121 defect records...
2025-08-04 15:44:14,375 - MOTHistoryImport - INFO - Successfully bulk inserted 121 defect records
2025-08-04 15:44:14,410 - MOTHistoryImport - INFO - Bulk batch committed: 100 successful, 0 failed, 100 vehicles, 761 tests, 121 defects, 0 not found
2025-08-04 15:44:14,428 - MOTHistoryImport - INFO - Progress: 13.1% (300/2285)
2025-08-04 15:44:14,442 - MOTHistoryImport - INFO - Processing batch 4/23 (100 registrations)
2025-08-04 15:45:57,035 - MOTHistoryImport - INFO - API Rate - Legacy: 0.11 RPS, Dynamic: 0 RPS (Daily: 310/500000)
2025-08-04 15:47:59,037 - MOTHistoryImport - INFO - API Rate - Legacy: 0.09 RPS, Dynamic: 0 RPS (Daily: 320/500000)
2025-08-04 15:49:59,576 - MOTHistoryImport - INFO - API Rate - Legacy: 0.10 RPS, Dynamic: 0 RPS (Daily: 330/500000)
2025-08-04 15:52:03,666 - MOTHistoryImport - INFO - API Rate - Legacy: 0.10 RPS, Dynamic: 0 RPS (Daily: 340/500000)
2025-08-04 15:54:11,982 - MOTHistoryImport - INFO - API Rate - Legacy: 0.10 RPS, Dynamic: 0 RPS (Daily: 350/500000)
2025-08-04 15:56:24,153 - MOTHistoryImport - INFO - API Rate - Legacy: 0.09 RPS, Dynamic: 0 RPS (Daily: 360/500000)
2025-08-04 15:58:41,210 - MOTHistoryImport - INFO - API Rate - Legacy: 0.09 RPS, Dynamic: 0 RPS (Daily: 370/500000)
2025-08-04 16:01:07,567 - MOTHistoryImport - INFO - API Rate - Legacy: 0.09 RPS, Dynamic: 0 RPS (Daily: 380/500000)
2025-08-04 16:03:26,258 - MOTHistoryImport - INFO - API Rate - Legacy: 0.09 RPS, Dynamic: 0 RPS (Daily: 390/500000)
2025-08-04 16:05:21,645 - MOTHistoryImport - INFO - Database connection closed
