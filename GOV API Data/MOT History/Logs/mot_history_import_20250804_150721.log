2025-08-04 15:07:21,834 - MOTHistoryImport - INFO - Logging initialized. Log file: Logs\mot_history_import_20250804_150721.log
2025-08-04 15:07:21,866 - MOTHistoryImport - INFO - Configuration loaded: {'database': {'server': 'MLNOESQLUAT01', 'database': 'Engineering', 'trusted_connection': True}, 'files': {'input_csv_file': 'vehicle_registrations_new.csv', 'log_directory': 'Logs'}, 'processing': {'batch_size': 100, 'request_timeout': 30, 'max_retries': 3}, 'logging': {'log_level': 'INFO'}, 'security': {'client_id_from_env': True, 'client_secret_from_env': True, 'api_key_from_env': True, 'db_password_from_env': False}}
2025-08-04 15:07:22,112 - MOTHistoryImport - INFO - JSON data logging initialized. File: Logs\mot_history_data_20250804_150721.json
2025-08-04 15:07:22,127 - MOTHistoryImport - INFO - Starting MOT History Data Import (Bulk Mode)
2025-08-04 15:07:22,143 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-04 15:07:22,534 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-04 15:07:22,548 - MOTHistoryImport - INFO - Truncating table: StageMOTVehicles
2025-08-04 15:07:22,600 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehicles
2025-08-04 15:07:22,616 - MOTHistoryImport - INFO - Truncating table: StageMOTTests
2025-08-04 15:07:22,677 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTTests
2025-08-04 15:07:22,694 - MOTHistoryImport - INFO - Truncating table: StageMOTDefects
2025-08-04 15:07:22,742 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTDefects
2025-08-04 15:07:22,763 - MOTHistoryImport - INFO - Truncating table: StageMOTVehiclesNotFound
2025-08-04 15:07:22,814 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehiclesNotFound
2025-08-04 15:07:22,842 - MOTHistoryImport - INFO - Reading vehicle registrations from SQL Server view
2025-08-04 15:07:22,860 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-04 15:07:23,116 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-04 15:07:23,247 - MOTHistoryImport - INFO - Read 2285 vehicle registrations from SQL Server
2025-08-04 15:07:23,264 - MOTHistoryImport - INFO - Processing batch 1/23 (100 registrations)
2025-08-04 15:07:23,303 - MOTHistoryImport - INFO - Requesting new OAuth2 token...
2025-08-04 15:07:23,581 - MOTHistoryImport - INFO - OAuth2 token obtained successfully
2025-08-04 15:07:33,696 - MOTHistoryImport - INFO - API Rate - Legacy: 1.10 RPS, Dynamic: 0 RPS (Daily: 0/500000)
2025-08-04 15:07:47,511 - MOTHistoryImport - INFO - API Rate - Legacy: 0.87 RPS, Dynamic: 0 RPS (Daily: 0/500000)
2025-08-04 15:08:06,125 - MOTHistoryImport - INFO - API Rate - Legacy: 0.72 RPS, Dynamic: 0 RPS (Daily: 0/500000)
2025-08-04 15:08:26,327 - MOTHistoryImport - INFO - API Rate - Legacy: 0.64 RPS, Dynamic: 0 RPS (Daily: 0/500000)
2025-08-04 15:08:52,608 - MOTHistoryImport - INFO - API Rate - Legacy: 0.47 RPS, Dynamic: 0 RPS (Daily: 0/500000)
2025-08-04 15:09:19,225 - MOTHistoryImport - INFO - Database connection closed
