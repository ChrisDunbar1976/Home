2025-07-23 15:06:30,140 - MOTHistoryImport - INFO - Logging initialized. Log file: Logs\mot_history_import_20250723_150630.log
2025-07-23 15:06:30,157 - MOTHistoryImport - INFO - Configuration loaded: {'database': {'server': 'MLNOESQLUAT01', 'database': 'Engineering', 'trusted_connection': True}, 'files': {'input_csv_file': 'vehicle_registrations_new.csv', 'log_directory': 'Logs'}, 'processing': {'batch_size': 100, 'request_timeout': 30, 'max_retries': 3}, 'logging': {'log_level': 'INFO'}}
2025-07-23 15:06:30,189 - MOTHistoryImport - INFO - JSON data logging initialized. File: Logs\mot_history_data_20250723_150630.json
2025-07-23 15:06:30,189 - MOTHistoryImport - INFO - Starting MOT History Data Import
2025-07-23 15:06:30,189 - MOTHistoryImport - INFO - Establishing database connection...
2025-07-23 15:06:30,344 - MOTHistoryImport - INFO - Database connection established successfully
2025-07-23 15:06:30,347 - MOTHistoryImport - INFO - Truncating table: StageMOTVehicles
2025-07-23 15:06:30,357 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehicles
2025-07-23 15:06:30,360 - MOTHistoryImport - INFO - Truncating table: StageMOTTests
2025-07-23 15:06:30,360 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTTests
2025-07-23 15:06:30,360 - MOTHistoryImport - INFO - Truncating table: StageMOTDefects
2025-07-23 15:06:30,387 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTDefects
2025-07-23 15:06:30,390 - MOTHistoryImport - INFO - Truncating table: StageMOTVehiclesNotFound
2025-07-23 15:06:30,398 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehiclesNotFound
2025-07-23 15:06:30,398 - MOTHistoryImport - INFO - Reading vehicle registrations from SQL Server view
2025-07-23 15:06:30,404 - MOTHistoryImport - INFO - Establishing database connection...
2025-07-23 15:06:30,457 - MOTHistoryImport - INFO - Database connection established successfully
2025-07-23 15:06:30,550 - MOTHistoryImport - INFO - Read 100 vehicle registrations from SQL Server
2025-07-23 15:06:30,555 - MOTHistoryImport - INFO - Processing batch 1/1 (100 registrations)
2025-07-23 15:06:30,559 - MOTHistoryImport - INFO - Requesting new OAuth2 token...
2025-07-23 15:06:30,772 - MOTHistoryImport - INFO - OAuth2 token obtained successfully
2025-07-23 15:06:42,469 - MOTHistoryImport - INFO - Current API rate: 0.90 RPS (Total requests: 10)
2025-07-23 15:06:52,919 - MOTHistoryImport - INFO - Current API rate: 0.93 RPS (Total requests: 20)
2025-07-23 15:07:03,765 - MOTHistoryImport - INFO - Current API rate: 0.93 RPS (Total requests: 30)
2025-07-23 15:07:13,622 - MOTHistoryImport - INFO - Current API rate: 0.95 RPS (Total requests: 40)
2025-07-23 15:07:26,175 - MOTHistoryImport - INFO - Current API rate: 0.91 RPS (Total requests: 50)
2025-07-23 15:07:38,530 - MOTHistoryImport - INFO - Current API rate: 0.90 RPS (Total requests: 60)
2025-07-23 15:07:50,438 - MOTHistoryImport - INFO - Current API rate: 0.89 RPS (Total requests: 70)
2025-07-23 15:08:02,992 - MOTHistoryImport - INFO - Current API rate: 0.86 RPS (Total requests: 80)
2025-07-23 15:08:14,403 - MOTHistoryImport - INFO - Current API rate: 0.85 RPS (Total requests: 90)
2025-07-23 15:08:28,587 - MOTHistoryImport - INFO - Current API rate: 0.81 RPS (Total requests: 100)
2025-07-23 15:08:28,897 - MOTHistoryImport - INFO - Batch committed: 100 successful, 0 failed
2025-07-23 15:08:28,897 - MOTHistoryImport - INFO - Running spFactMOTVehicles_Merge...
2025-07-23 15:08:28,956 - MOTHistoryImport - INFO - spFactMOTVehicles_Merge completed successfully
2025-07-23 15:08:28,956 - MOTHistoryImport - INFO - Running spFactMOTTests_Merge...
2025-07-23 15:08:29,071 - MOTHistoryImport - INFO - spFactMOTTests_Merge completed successfully
2025-07-23 15:08:29,087 - MOTHistoryImport - INFO - Running spFactMOTDefects_Merge...
2025-07-23 15:08:29,122 - MOTHistoryImport - INFO - spFactMOTDefects_Merge completed successfully
2025-07-23 15:08:29,127 - MOTHistoryImport - INFO - All merge stored procedures executed after batch.
2025-07-23 15:08:29,130 - MOTHistoryImport - INFO - Progress: 100.0% (100/100)
2025-07-23 15:08:29,136 - MOTHistoryImport - INFO - ==================================================
2025-07-23 15:08:29,139 - MOTHistoryImport - INFO - MOT HISTORY DATA IMPORT COMPLETED
2025-07-23 15:08:29,142 - MOTHistoryImport - INFO - ==================================================
2025-07-23 15:08:29,145 - MOTHistoryImport - INFO - Total registrations processed: 100
2025-07-23 15:08:29,147 - MOTHistoryImport - INFO - Successful imports: 100
2025-07-23 15:08:29,152 - MOTHistoryImport - INFO - Failed imports: 0
2025-07-23 15:08:29,155 - MOTHistoryImport - INFO - Registrations not found: 0
2025-07-23 15:08:29,157 - MOTHistoryImport - INFO - Vehicles inserted: 100
2025-07-23 15:08:29,160 - MOTHistoryImport - INFO - Tests inserted: 552
2025-07-23 15:08:29,163 - MOTHistoryImport - INFO - Defects inserted: 49
2025-07-23 15:08:29,165 - MOTHistoryImport - INFO - Total duration: 0:01:58.946642
2025-07-23 15:08:29,170 - MOTHistoryImport - INFO - Average time per registration: 0:00:01.189466
2025-07-23 15:08:29,172 - MOTHistoryImport - INFO - ========================= API RATE STATS =========================
2025-07-23 15:08:29,175 - MOTHistoryImport - INFO - Total API requests: 100
2025-07-23 15:08:29,177 - MOTHistoryImport - INFO - Final RPS (60-sec window): 0.81
2025-07-23 15:08:29,181 - MOTHistoryImport - INFO - Average RPS (overall): 0.84
2025-07-23 15:08:29,182 - MOTHistoryImport - INFO - Configured rate delay: 0.1s
2025-07-23 15:08:29,187 - MOTHistoryImport - INFO - API request duration: 118.6s
2025-07-23 15:08:29,189 - MOTHistoryImport - INFO - ==================================================
2025-07-23 15:08:29,195 - MOTHistoryImport - INFO - Database connection closed
