2025-08-07 07:05:03,973 - MOTHistoryImport - INFO - Logging initialized. Log file: Logs\mot_history_import_20250807_070503.log
2025-08-07 07:05:03,974 - MOTHistoryImport - INFO - Configuration loaded: {'database': {'server': 'MLNOESQLUAT01', 'database': 'Engineering', 'trusted_connection': True}, 'files': {'log_directory': 'Logs'}, 'processing': {'batch_size': 100, 'request_timeout': 30, 'max_retries': 3}, 'logging': {'log_level': 'INFO'}}
2025-08-07 07:05:03,976 - MOTHistoryImport - INFO - JSON data logging initialized. File: Logs\mot_history_data_20250807_070503.json
2025-08-07 07:05:03,977 - MOTHistoryImport - INFO - Starting MOT History Data Import (Bulk Mode)
2025-08-07 07:05:03,978 - MOTHistoryImport - INFO - Establishing database connection...
2025-08-07 07:05:04,218 - MOTHistoryImport - INFO - Database connection established successfully
2025-08-07 07:05:04,218 - MOTHistoryImport - INFO - Truncating table: StageMOTVehicles
2025-08-07 07:05:04,321 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehicles
2025-08-07 07:05:04,322 - MOTHistoryImport - INFO - Truncating table: StageMOTTests
2025-08-07 07:05:04,372 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTTests
2025-08-07 07:05:04,373 - MOTHistoryImport - INFO - Truncating table: StageMOTDefects
2025-08-07 07:05:04,397 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTDefects
2025-08-07 07:05:04,397 - MOTHistoryImport - INFO - Truncating table: StageMOTVehiclesNotFound
2025-08-07 07:05:04,401 - MOTHistoryImport - INFO - Successfully truncated table: StageMOTVehiclesNotFound
2025-08-07 07:05:04,402 - MOTHistoryImport - INFO - Reading vehicle registrations from source database: MLNOESQLEXP01
2025-08-07 07:05:06,606 - MOTHistoryImport - ERROR - Failed to read vehicle registrations from source database: ('42000', '[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Cannot open database "METROFMS" requested by the login. The login failed. (4060) (SQLDriverConnect); [42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Cannot open database "METROFMS" requested by the login. The login failed. (4060)')
2025-08-07 07:05:06,607 - MOTHistoryImport - ERROR - Import process failed: ('42000', '[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Cannot open database "METROFMS" requested by the login. The login failed. (4060) (SQLDriverConnect); [42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Cannot open database "METROFMS" requested by the login. The login failed. (4060)')
2025-08-07 07:05:06,612 - MOTHistoryImport - ERROR - Traceback: Traceback (most recent call last):
  File "D:\Scripts\GOV API Data\MOT History\GOV_API_MOTHistory_Import.py", line 1671, in run_import
    registrations = self.read_vehicle_registrations()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\Scripts\GOV API Data\MOT History\GOV_API_MOTHistory_Import.py", line 1420, in read_vehicle_registrations
    source_connection = pyodbc.connect(source_conn_str)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', '[42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Cannot open database "METROFMS" requested by the login. The login failed. (4060) (SQLDriverConnect); [42000] [Microsoft][ODBC SQL Server Driver][SQL Server]Cannot open database "METROFMS" requested by the login. The login failed. (4060)')

2025-08-07 07:05:06,615 - MOTHistoryImport - INFO - Database connection closed
